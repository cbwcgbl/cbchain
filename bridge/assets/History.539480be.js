import{d as e,u as a,t as s,g as t,r as l,w as n,R as i,s as r,a as o,S as c,i as d,j as h,f as u,n as m,e as v,h as g,T as f,U as y,E as p,V as b,K as k,F as C,G as w,M as x,H,I as T,O as I,Q as A,J as E}from"./index.91959083.js";import{_ as M}from"./no-data.d1244a8f.js";var j=e({name:"History",setup(){const e=y(),{t:p}=a(),b=s(t,"address"),k=s(t,"historyList"),C=s(t,"isMobile"),w=l([]),x=l(!1),H=l(1),T=l(10),I=l(0),A=async()=>{var e;x.value=!0;try{const a=await f(H.value,T.value);if(a&&a.data){const s=(null==(e=a.data)?void 0:e.txs)||[];if(1===H.value&&Object.keys(k.value).length){const e=k.value;if(s.forEach((a=>{const s=a.depositHash;s&&e[s]&&delete e[s]})),Object.keys(e).length){const a=Object.values(e).sort(((e,a)=>a.timestamp-e.timestamp));w.value=a.concat(s),localStorage.setItem("newHistory",JSON.stringify(e))}else localStorage.removeItem("newHistory")}else w.value=s;I.value=a.data.count||0}}catch(a){console.log("获取历史记录失败：",a)}x.value=!1};n(b,(()=>{H.value=1,I.value=0,b.value?A():w.value=[]})),i((()=>{b.value&&(H.value=1,A())}));return{t:p,tableData:w,showMain:r,page:H,address:b,loading:x,isMobile:C,compressAddress:o,timestampToTime:c,total:I,isEthereum:d,isCUBE:h,getHashUrl:e=>"eth"==e?"https://etherscan.io":"cube"==e?"https://www.cubescan.network/en-us":"",formatBalance:u,handleConnect:m,handleCurrentChange:e=>{H.value=e,A()},refresh:()=>{H.value=1,(null==e?void 0:e.refs.pagination)?e.refs.pagination.internalCurrentPage=1:A()},defaultEthImg:v,defaultCubeImg:g}}});const O={key:0,class:"history-header"},U={class:"flex-y-center"},$={class:"history-title"},D={class:"flex-y-center"},S=H("i",{class:"refresh-icon"},null,-1),B={class:"ml-6"},L={key:0,class:"table-header"},_={class:"direction-table"},J={class:"in-number-table"},P={class:"hash-table label"},F={class:"fee-table"},G={class:"time-table"},K={class:"status-table label"},N={class:"table-body"},Q={class:"direction-table"},R=H("span",{class:"arrow"},null,-1),V={class:"in-number-table"},W={class:"text"},q={class:"hash-table flex-y"},z={key:1,class:"hash-link"},X={key:3,class:"hash-link"},Y={class:"fee-table"},Z={class:"time-table"},ee={class:"status-table"},ae={key:0,class:"main-color"},se={key:2,class:"failed"},te={key:1,class:"no-data flex-y flex-center"},le=H("img",{src:M,alt:"no data"},null,-1),ne={key:2,class:"need-connect flex-y flex-center"},ie=H("img",{src:M,alt:"no data"},null,-1);j.render=function(e,a,s,t,l,n){const i=p("el-pagination"),r=b("loading");return k((C(),w("div",{class:"main history-main","element-loading-text":e.t("common.loadingText"),"element-loading-spinner":"el-icon-loading"},[e.showMain?(C(),w(x,{key:0},[e.address?(C(),w("section",O,[H("div",U,[H("div",$,T(e.t("app.historyTotal",{total:e.total})),1)]),H("div",D,[H("div",{class:"refresh-button",onClick:a[1]||(a[1]=(...a)=>e.refresh&&e.refresh(...a))},[S,H("span",B,T(e.t("common.refresh")),1)])])])):I("",!0),H("section",{class:["history-table",{"table-no-data":!e.tableData.length}]},[e.address?(C(),w("div",L,[H("div",_,T(e.t("history.direction")),1),H("div",J,T(e.t("history.amountAndUnit")),1),H("div",P,T(e.t("history.hash")),1),H("div",F,T(e.t("history.fee")),1),H("div",G,T(e.t("history.createTime")),1),H("div",K,T(e.t("history.status")),1)])):I("",!0),H("div",N,[e.tableData.length?(C(),w(x,{key:0},[(C(!0),w(x,null,A(e.tableData,((a,s)=>{var t,l;return C(),w("div",{key:s,class:"table-item"},[H("div",Q,[H("img",{class:"direction-table-icon",src:"eth"===(null==(t=a.sourceChain)?void 0:t.toLowerCase())?e.defaultEthImg:e.defaultCubeImg,alt:`${a.sourceChain}`},null,8,["src","alt"]),R,H("img",{class:"direction-table-icon",src:"eth"===(null==(l=a.destChain)?void 0:l.toLowerCase())?e.defaultEthImg:e.defaultCubeImg,alt:`${a.destChain}`},null,8,["src","alt"])]),H("div",V,[E(T(a.sourceToken)+" ",1),H("div",W,T(e.formatBalance(a.depositAmount)),1)]),H("div",q,[a.depositHash?(C(),w("a",{key:0,class:"hash-link",href:`${e.getHashUrl(a.sourceChain)}/tx/${a.depositHash}`,target:"_blank",rel:"noopener noreferrer"},T(e.isMobile?e.compressAddress(a.depositHash,6,6):e.compressAddress(a.depositHash,8,8)),9,["href"])):(C(),w("div",z,"-")),a.withdrawHash?(C(),w("a",{key:2,class:"hash-link",href:`${e.getHashUrl(a.destChain)}/tx/${a.withdrawHash}`,target:"_blank",rel:"noopener noreferrer"},T(e.isMobile?e.compressAddress(a.withdrawHash,6,6):e.compressAddress(a.withdrawHash,8,8)),9,["href"])):(C(),w("div",X,"-"))]),H("div",Y,T(a.fee)+" "+T(a.sourceToken),1),H("div",Z,T(e.timestampToTime(a.timestamp)),1),H("div",ee,[5==a.status?(C(),w("span",ae,T(e.t("history.recived")),1)):I("",!0),a.status<5?(C(),w(x,{key:1},[E(T(e.t("history.ongoing")),1)],64)):I("",!0),10==a.status?(C(),w("span",se,T(e.t("history.pending")),1)):I("",!0)])])})),128)),H(i,{ref:"pagination",hideOnSinglePage:!0,class:"table-pagination","current-page":e.page,layout:"prev, pager, next",total:e.total,onCurrentChange:e.handleCurrentChange},null,8,["current-page","total","onCurrentChange"])],64)):e.address?(C(),w("div",te,[le,H("div",null,T(e.t("history.noData")),1)])):(C(),w("div",ne,[ie,H("div",null,[H("span",null,T(e.t("history.connect")),1),H("span",{class:"connect-wallet ",onClick:a[2]||(a[2]=(...a)=>e.handleConnect&&e.handleConnect(...a))},T(e.t("wallet.connectWallet")),1)])]))])],2)],64)):I("",!0)],8,["element-loading-text"])),[[r,e.loading]])};export default j;
